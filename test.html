<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simple Payment Gateway (ZapUpi)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      body { font-family: Arial, sans-serif; padding:30px; max-width:350px; margin:auto;}
      input, button { width: 100%; margin: 8px 0; padding:8px; }
      .msg { margin:12px 0;color: red;}
    </style>
</head>
<body>
    <h2>Send Payment</h2>
    <form id="payForm">
        <input type="number" name="amount" placeholder="Amount (â‚¨)" required min="1">
        <input type="text" name="order_id" placeholder="Order ID" required>
        <input type="text" name="custumer_mobile" placeholder="Mobile (Optional)">
        <input type="text" name="remark" placeholder="Remark (Optional)">
        <button type="submit">Pay Now</button>
    </form>
    <div class="msg" id="msg"></div>

    <script>
      // DO NOT share these in public projects!
      const token_key = "e221f42e221b4e37a7db3064c677718b";
      const secret_key = "71c2abbdaf6248281a6943397455cd36";

      document.getElementById('payForm').onsubmit = async function(e){
          e.preventDefault();
          const form = e.target;
          const fd = new FormData(form);
          fd.append('token_key', token_key);
          fd.append('secret_key', secret_key);

          document.getElementById("msg").innerText = "Processing...";

          const data = new URLSearchParams([...fd]).toString();
          try {
              const res = await fetch("https://api.zapupi.com/api/create-order", {
                  method: "POST",
                  headers: {
                    "Content-Type": "application/x-www-form-urlencoded"
                  },
                  body: data
              });
              const json = await res.json();
              if(json.status === "success" && json.payment_url){
                  document.getElementById("msg").innerText = "Redirecting...";
                  window.location.href = json.payment_url;
              } else {
                  document.getElementById("msg").innerText = json.message || "Failed to create order.";
              }
          } catch(err){
              document.getElementById("msg").innerText = "Network error. Try again.";
          }
      }
    </script>
</body>
</html>
